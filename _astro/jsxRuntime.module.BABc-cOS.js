import{h as p,y as g}from"./hooks.module.C57PM44S.js";import{l as v}from"./preact.module.UE3xzrEN.js";let f=[],u=0;const d=4;let m=e=>{let n=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(s){return t.lc=n.push(s),()=>{for(let i=u+d;i<f.length;)f[i]===s?f.splice(i,d):i+=d;let r=n.indexOf(s);~r&&(n.splice(r,1),--t.lc||t.off())}},notify(s,r){let i=!f.length;for(let l of n)f.push(l,t.value,s,r);if(i){for(u=0;u<f.length;u+=d)f[u](f[u+1],f[u+2],f[u+3]);f.length=0}},off(){},set(s){let r=t.value;r!==s&&(t.value=s,t.notify(r))},subscribe(s){let r=t.listen(s);return s(t.value),r},value:e};return t};function S(e,n,t){let s=new Set([...n,void 0]);return e.listen((r,i,l)=>{s.has(l)&&t(r,i,l)})}function E(e,n={}){let[,t]=p({}),[s]=p(e.get());return g(()=>{s!==e.get()&&t({})},[]),g(()=>{let r,i,l,o=()=>{r||(r=1,i=setTimeout(()=>{r=void 0,t({})}))};return n.keys?l=S(e,n.keys,o):l=e.listen(o),()=>{l(),clearTimeout(i)}},[e,""+n.keys]),e.get()}let y=[];if(typeof window<"u"){const e=localStorage.getItem("cart-storage");y=e?JSON.parse(e):[]}const a=m(y);typeof window<"u"&&a.subscribe(e=>{localStorage.setItem("cart-storage",JSON.stringify(e))});const k=e=>{a.set([...a.get(),e])},I=(e,n)=>{const t=a.get().map(s=>s.name===e?{...s,total:n}:s);a.set(t)},w=e=>{const n=a.get().filter(t=>t.name!==e);a.set(n)};var b=0;function x(e,n,t,s,r,i){n||(n={});var l,o,c=n;if("ref"in c)for(o in c={},n)o=="ref"?l=n[o]:c[o]=n[o];var _={type:e,props:c,key:t,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--b,__i:-1,__u:0,__source:r,__self:i};if(typeof e=="function"&&(l=e.defaultProps))for(o in l)c[o]===void 0&&(c[o]=l[o]);return v.vnode&&v.vnode(_),_}export{E as a,I as b,k as c,a as d,w as r,x as u};
